<!doctype html>
<html>

<head>
    <title>Speech Recognition Models</title>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <script src="hark.bundle.js"></script>
    <script src="streaming_client.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"
            integrity="sha512-v8ng/uGxkge3d1IJuEo6dJP8JViyvms0cly9pnbfRxT6/31c3dRWxIiwGnMSWwZjHKOuY3EVmijs7k1jz/9bLA=="
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io-stream/0.9.1/socket.io-stream.js"
            integrity="sha512-CIsFvh6QCVJHM5XSBQFm7a3mCErndwx9AugcP+nf/YxUQVVWY14klqk+3IG/qNqDpHg5pYVcZWiMt9SeZTiQnw=="
            crossorigin="anonymous"></script>
</head>
<body>
<button type="button" id="start_btn">Start</button>
<button type="button" id="stop_btn">Stop</button>
<p id="output"></p>
</body>
<script>
    $(document).ready(function () {
        const streaming = new StreamingClient();
        ss.forceBase64 = true;
        let language = 'en-IN';
        let socketURL = 'http://35.192.29.24:9008/';
        $('#start_btn').on('click', function () {
            streaming.connect(socketURL, language, function (action, id) {
                console.log("Connected", id);
                if (action === null) {
                    streaming.startStreaming(function (transcript) {
                        console.log("Data", transcript);
                        document.getElementById('output').innerHTML = transcript;
                    }, (e) => {
                        console.log("I got error", e);
                    })
                } else {
                    console.log("Action", action, id)
                }
            })
        });

        $('#stop_btn').on('click', function () {
            streaming.stopStreaming();
            streaming.punctuateText(document.getElementById('output').innerHTML, 'https://inference.vakyansh.in/punctuate', (status, text) => {
                document.getElementById('output').innerHTML = text;
            }, (status, error) => {
                console.log("Failed to punctuate", status, error);
            })
        });
    });
</script>
</html>